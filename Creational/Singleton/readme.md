## 单例模式（一个用户多次实例化只能拿到同一个实例）

- 简介

对于系统中的某些类来说，只有一个实例很重要，例如，一个系统中可以存在多个打印任务，但是只能有一个正在工作的任务；一个系统只能有一个窗口管理器或文件系统；一个系统只能有一个计时工具或ID（序号）生成器。

如何保证一个类只有一个实例并且这个实例易于被访问呢？定义一个全局变量可以确保对象随时都可以被访问，但不能防止我们实例化多个对象。

一个更好的解决办法是让类自身负责保存它的唯一实例。这个类可以保证没有其他实例被创建，并且它可以提供一个访问该实例的方法。这就是单例模式的模式动机。

单例模式(Singleton Pattern)：单例模式确保某一个类只有一个实例，而且自行实例化并向整个系统提供这个实例，这个类称为单例类，它提供全局访问的方法。

单例模式的要点有三个：
- 一是某个类只能有一个实例；
- 二是它必须自行创建这个实例；
- 三是它必须自行向整个系统提供这个实例。

- 结构

![image](https://design-patterns.readthedocs.io/zh_CN/latest/_images/Singleton.jpg)

单例类拥有一个私有构造函数，确保用户无法通过new关键字直接实例化它。除此之外，该模式中包含一个静态私有成员变量与静态公有的工厂方法，该工厂方法负责检验实例的存在性并实例化自己，然后存储在静态成员变量中，以确保只有一个实例被创建。

需要注意如下三点：

- 单例类的构造函数为私有；
- 提供一个自身的静态私有成员变量；
- 提供一个公有的静态工厂方法。


- 优缺点

  - 主要优点在于提供了对唯一实例的受控访问并可以节约系统资源；
  - 其主要缺点在于因为缺少抽象层而难以扩展，且单例类职责过重。


- demo说明

[源代码](https://learnku.com/docs/php-design-patterns/2018/Singleton/1494)

多次实例化只能得到同一个实例，由于getInstance()和$instance都是static，所以下一次实例化直接保留instance属性的变化。

- 建议：

有全局唯一要求，才需要单例